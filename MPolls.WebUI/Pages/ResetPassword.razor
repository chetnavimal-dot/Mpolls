@page "/reset-password"
@layout AuthLayout

<PageTitle>Reset Password</PageTitle>

<MudPaper Class="mx-auto my-6 pa-6" Style="max-width:400px;">
    @if (ShowSuccessMessage)
    {
        <MudAlert Severity="Severity.Success" Class="my-4">
            <MudText Typo="Typo.subtitle1">Password reset</MudText>
            <MudText Typo="Typo.body2">@Response.Payload.Message.</MudText>
        </MudAlert>
        <MudButton Color="Color.Primary" Variant="Variant.Filled" Href="/login" Class="mt-2 d-inline-block">Proceed to login</MudButton>
    }
    else
    {
        <MudText Typo="Typo.h5" Class="mb-2">Reset your password</MudText>
        <MudText Typo="Typo.subtitle2" Class="mb-4">Enter the email associated with your account and we'll send you a reset link.</MudText>

        <EditForm EditContext="_editContext" OnValidSubmit="HandleValidSubmit">
            <DataAnnotationsValidator/>
            <ValidationSummary/>

            <MudTextField Label="Email" @bind-Value="_model.Email" For="@(() => _model.Email)" Required="true" Immediate="true"/>

            <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Disabled="_isSubmitting" Class="mt-4">
                @if (_isSubmitting)
                {
                    <MudProgressCircular Size="Size.Small" Indeterminate="true" Style="margin-right:12px;"/>
                }
                Send reset email
            </MudButton>
        </EditForm>

        @if (!string.IsNullOrWhiteSpace(_errorMessage))
        {
            <MudAlert Severity="Severity.Error" Class="mt-4">@_errorMessage</MudAlert>
        }
    }
</MudPaper>
